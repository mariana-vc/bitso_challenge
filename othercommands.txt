docker compose up

connections
postgres >> Conn Type as Postgress , password as airflow
pronostico_api >> Conn Type as HTTP 


docker-compose down
docker system prune -f
docker volume prune -f
docker network prune -f
rm -rf ./mnt/postgres/*
docker rmi -f $(docker images -a -q)

docker exec -it <mycontainer> sh

psql -U airflow -d airflow_db

select id_mun, h_loc, avg(temp) as avg_temp, prec, avg(prec) as avg_prec OVER (PARTITION BY id_mun)
from (
  select id_mun, h_loc, temp , prec, 
  row_number() over (PARTITION BY id_mun ORDER BY h_loc DESC) as rn
  from pronosticoxmunicipios
) sub
where rn <= 2;

SELECT id_es, id_mun, avg(temp) as avg_temp , avg(prec) as avg_prec INTO new_table FROM ( 
    SELECT id_es, id_mun, temp, prec 
    FROM pronosticoxmunicipios_09_12_2022_18 
    UNION ALL  
    SELECT id_es, id_mun, temp , prec
    FROM pronosticoxmunicipios_09_12_2022_19 ) sub
GROUP BY id_es, id_mun;


COPY data_municipios_20220503 FROM '/opt/postgres/data_municipios/20220503/data.csv' DELIMITER ',' CSV HEADER;


\copy data_municipios_20220503 FROM '/opt/postgres/data_municipios/20220503/data.csv' DELIMITER ',' CSV HEADER;